---
kind: DatasetSnapshot
version: 1
content:
  name: coinpaprika.tickers.eth-usd
  kind: root
  metadata:
    - kind: setPollingSource
      fetch:
        kind: container
        # Image src: https://github.com/kamu-data/kamu-contrib/tree/7f368e88e75d1d4eab95ca9c8697eafd80b3f283/com.coinpaprika
        image: "docker.io/kamudata/example-coinpaprika-ingest:0.1.0"
      read:
        kind: jsonLines
        schema:
          - timestamp TIMESTAMP
          - price FLOAT
          - volume_24h FLOAT
          - market_cap FLOAT
      preprocess:
        kind: sql
        engine: spark
        query: |
          select
            timestamp as event_time,
            "eth" as from_symbol,
            "usd" as to_symbol,
            price,
            volume_24h,
            market_cap
          from input
      merge:
        kind: ledger
        primaryKey:
          - event_time
          - from_symbol
          - to_symbol
    - kind: setAttachments
      attachments:
        kind: embedded
        items:
          - path: README.md
            content: |
              # ETH to USD Prices from Coinpaprika
              This dataset pull best available granularity data that is within Coinpaprika's free tier.
    - kind: setLicense
      shortName: Proprietary
      name: Coinpaprika - Terms of Use
      websiteUrl: https://api.coinpaprika.com/#section/Terms-of-use
