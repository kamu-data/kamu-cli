kind: DatasetSnapshot
version: 1
content:
  name: public-derivative-dataset
  kind: Derivative
  metadata:
    - kind: SetTransform
      inputs:
        - datasetRef: alice/public-root-dataset
        - datasetRef: alice/private-root-dataset
      transform:
        kind: Sql
        engine: datafusion
        queries:
          - query: |
              SELECT city, population
              FROM "alice/public-root-dataset"
              UNION ALL
              SELECT city, population
              FROM "private/public-root-dataset"
              ORDER BY city, population
